import React, { useState,useEffect } from "react";
import { Container, Row, Col, Offcanvas, Button } from "react-bootstrap";
import { v4 as uuid } from "uuid";
import "./Combine.css";
import Logic from "../Logic/Logic";
import { DragDropContext, Droppable, Draggable } from "react-beautiful-dnd";
import { AiOutlinePlusCircle } from "react-icons/ai";
import { SiAmazonalexa } from "react-icons/si";
import { toast, ToastContainer } from "react-toastify";
import "react-toastify/dist/ReactToastify.css";
import { NavLink } from "react-router-dom";
import ReactPaginate from "react-paginate";
import Dragdrop from "./Dragdrop";
import {VscCircleLargeOutline} from "react-icons/vsc";
import {Modal,Form} from "react-bootstrap"



const PER_PAGE = 2;

function App({ components, setComponents}) {

// large pop part start================================>
const [fullscreenu, setFullscreenu] = useState(true);
const [showu, setShowu] = useState(false);

const [fullscreenv, setFullscreenv] = useState(true);
const [showv, setShowv] = useState(false);

const [fullscreenw, setFullscreenw] = useState(true);
const [showw, setShoww] = useState(false);

const [fullscreenx, setFullscreenx] = useState(true);
const [showx, setShowx] = useState(false);

const [fullscreeny, setFullscreeny] = useState(true);
const [showy, setShowy] = useState(false);
// large pop up ends====================================>

  // pagination start===============================================>
  const [currentPage, setCurrentPage] = useState(0);
  // pagination ends===============================================>

  const [lgShow, setLgShow] = useState(false);
  // off canvas functionality start===========================>
  const [show, setShow] = useState(false);
  const handleClose = () =>setShow(false);
  const handleShow = () => setShow(true);
// off canvas functionality start==============================>


// large pop up functionality start=============================>
  const values = [true];

  function handleShowu(breakpoint) {
    setFullscreenu(breakpoint);
    setShowu(true);
  }

  function handleShowv(breakpoint) {
    setFullscreenv(breakpoint);
    setShowv(true);
  }

  function handleShoww(breakpoint) {
    setFullscreenw(breakpoint);
    setShoww(true);
  }

  function handleShowx(breakpoint) {
    setFullscreenx(breakpoint);
    setShowx(true);
  }

  function handleShowy(breakpoint) {
    setFullscreeny(breakpoint);
    setShowy(true);
  }
// large pop up functionality ends================================>

  // post data with post selection part start==============================>
  const [postsData, setPostsData] = useState([
    {
      id: uuid(),
      question: { type: "Boolean", title: "Hubspot Is Best For Marketing Automation?" },
    },
    {
      id: uuid(),
      question: { type: "Boolean", title: "React Js Is a Front-End Technology " },
    },
  ]);
  const [selectedPosts, setSelectedPosts] = useState([]);

   // data storage functionality start======================================>
   

  
  //  data storage functionality ends=========================================>

  // post data with post selection part ends==========================================================>

  function addComponent() {
    setComponents((prev) => [
      ...prev,
      { id: uuid(), question: { type: "Boolean", title: "" }},
    ]);
    console.log(components)
  }

  /* drag and drop functionality start===========================> */

  const reorder = (list, startIndex, endIndex) => {
    const result = Array.from(list);
    const [removed] = result.splice(startIndex, 1);
    result.splice(endIndex, 0, removed);
    return result;
  };

  
  const onDragEnd = (result) => {

    if (!result.destination) {
      return;
    }
   
    const reorderedItems = reorder(
      components,
      result.source.index,
      result.destination.index
    );
    setComponents(reorderedItems);
  };
   
  /* drag and drop functionality ends===================================> */
   
  //on submit functionality start=====================================>
  const handleData = (e) => {
    e.preventDefault();
    setSelectedPosts([]);
    setComponents((prev) => [...prev, ...selectedPosts]);
    toast.success("Questions Added Successfully");
  };
  //on submit functionality ends=====================================>

  // select functionality start=======================================>

  const handleSelect = (e, id, question) => {
    
    setSelectedPosts((prev) => {

      const foundIndex = prev.findIndex((item) => item.id === id);

      // if index is not find(if question is not selected) then add this
      if (foundIndex === -1) {
        return [...prev, { id, question }];
      }
      // if index is find(if question is  selected) then remove this
      return prev.filter((item) => item.id !== id);
    });
  };
  //select functionality ends================================================>


  //pagination start========================================================>
   const handlePageClick = ({ selected: selectedPage }) => {
    console.log("selectedPage", selectedPage);
    setCurrentPage(selectedPage);
    };
  const offset = currentPage * PER_PAGE;

  const current = components.slice(offset, offset + PER_PAGE);

  const pageCount = Math.ceil(components.length / PER_PAGE);
  // pagination ends===========================================================>

  //  search query start=========================>

  // search query ends===========================>

  return (
    <>
      <ToastContainer/>
      <Container>
      <Row>
      <Col md={6} lg={6}>
      <div className="lorem-head">
      <h3>Lorem ipsum doler sit amet</h3>
      </div>
      </Col>
    {/* select template start====================================== */}
      <Col md={6} lg={6}>
      <div className="select-temp">
     {/*  template pop up start==============> */}
   
   <Button onClick={() => setLgShow(true)}>Select Template</Button>
  
   <Modal
     size="lg"
     show={lgShow}
     onHide={() => setLgShow(false)}
     aria-labelledby="example-modal-sizes-title-lg"
     
   >
     <Modal.Header closeButton>
       <Modal.Title id="example-modal-sizes-title-lg">
        View All Templates
       </Modal.Title>
     </Modal.Header>
     <Modal.Body >
   {/*  internal design start===========================> */}
   <Container>

   <Row className="pop-row">
   
   <Col lg={3} md={3}>
   <div className="preone">
   <img src="../images/pre1.png" alt="Logo"/>
   </div>
   </Col>
   <Col lg={6} md={6} className="lorem-all">
   <div className="lorem-headingone">
   <h5>Lorem Ipsum Dolor</h5>
   </div>
   <div className="lorem-paraone">
   <p>Lorem Ipsum</p>
   </div>
    </Col>
   <Col lg={3} md={3} className="preview">
  {/* preview part pop up start===============================*/}
  <div className="useit">
  {values.map((v, idx) => (
   <a key={idx} className="usethisone" onClick={() => handleShowu(v)}>
     Preview
      {typeof v === 'string' && `below ${v.split('-')[0]}`}
    </a>
    ))}
    </div>

    <div className="usethis">
    <a className="usethistwo">Use This Template</a>
    </div>
 
  <Modal show={showu} fullscreen={fullscreenu} onHide={() => setShowu(false)}>
  <Modal.Header closeButton>
  </Modal.Header>
  <Modal.Body>
  {/*  page design start =============================>*/}
   
   <div className="orange">
   <Container>
   <Row>
   <div className="ques-one">
   <h5>1. Lorem ipsum dolor sit amet,cosecuter adipicing elit</h5>
   </div>
  
   <div className="black-one col-md-6 col-lg-6">
   <input class="first" type="radio" name="gender" value="Normal"/>lorem liter go elimpus de rue
   </div>
  
   <div className="black-one col-md-6 col-lg-6">
   <input class="first" type="radio" name="gender" value="Normal"/>lorem liter go elimpus de rue
   </div>

   <div className="black-one col-md-6 col-lg-6">
   <input class="first" type="radio" name="gender" value="Normal"/>lorem liter go elimpus de rue
   </div>

   <div className="black-one col-md-6 col-lg-6">
   <input class="first" type="radio" name="gender" value="Normal"/>lorem liter go elimpus de rue
   </div>
   

   </Row>
   </Container>
  
   </div>
  
  {/*  page design ends =============================>*/}
  </Modal.Body>
  </Modal>
  {/*preview part ends ================================== */}
   </Col>

   </Row>

   <Row className="pop-row">
   <Col lg={3} md={3}>
   <div className="preone">
   <img src="../images/pre5.png" alt="Logo"/>
   </div>
   </Col>
   <Col lg={6} md={6} className="lorem-all">
   <div className="lorem-headingone">
   <h5>Lorem Ipsum Dolor</h5>
   </div>
   <div className="lorem-paraone">
   <p>Lorem Ipsum</p>
   </div>
    </Col>
   <Col lg={3} md={3}>
   {/* preview part pop up start===============================*/}
  <div className="useit">
  {values.map((v, idx) => (
   <a key={idx} className="usethisone" onClick={() => handleShowv(v)}>
     Preview
      {typeof v === 'string' && `below ${v.split('-')[0]}`}
    </a>
    ))}
    </div>

    <div className="usethis">
    <a className="usethistwo">Use This Template</a>
    </div>
 
  <Modal show={showv} fullscreen={fullscreenv} onHide={() => setShowv(false)}>
    <Modal.Header closeButton>
      <Modal.Title>2</Modal.Title>
    </Modal.Header>
    <Modal.Body>2</Modal.Body>
  </Modal>
  {/*preview part ends ================================== */}
   </Col>
  </Row>

  <Row className="pop-row">
   <Col lg={3} md={3}>
   <div className="preone">
   <img src="../images/pre3.png" alt="Logo"/>
   </div>
   </Col>
   <Col lg={6} md={6} className="lorem-all">
   <div className="lorem-headingone">
   <h5>Lorem Ipsum Dolor</h5>
   </div>
   <div className="lorem-paraone">
   <p>Lorem Ipsum</p>
   </div>
    </Col>
   <Col lg={3} md={3}>
    {/* preview part pop up start===============================*/}
  <div className="useit">
  {values.map((v, idx) => (
   <a key={idx} className="usethisone" onClick={() => handleShoww(v)}>
     Preview
      {typeof v === 'string' && `below ${v.split('-')[0]}`}
    </a>
    ))}
    </div>

    <div className="usethis">
    <a className="usethistwo">Use This Template</a>
    </div>
 
  <Modal show={showw} fullscreen={fullscreenw} onHide={() => setShoww(false)}>
    <Modal.Header closeButton>
      <Modal.Title>3</Modal.Title>
    </Modal.Header>
    <Modal.Body>3</Modal.Body>
  </Modal>
  {/*preview part ends ================================== */}
   </Col>
  </Row>

  <Row className="pop-row">
   <Col lg={3} md={3}>
   <div className="preone">
   <img src="../images/pre2.png" alt="Logo"/>
   </div>
   </Col>
   <Col lg={6} md={6} className="lorem-all">
   <div className="lorem-headingone">
   <h5>Lorem Ipsum Dolor</h5>
   </div>
   <div className="lorem-paraone">
   <p>Lorem Ipsum</p>
   </div>
    </Col>
   <Col lg={3} md={3}>
   {/* preview part pop up start===============================*/}
   <div className="useit">
   {values.map((v, idx) => (
    <a key={idx} className="usethisone" onClick={() => handleShowx(v)}>
      Preview
       {typeof v === 'string' && `below ${v.split('-')[0]}`}
     </a>
     ))}
     </div>
 
     <div className="usethis">
     <a className="usethistwo">Use This Template</a>
     </div>
  
   <Modal show={showx} fullscreen={fullscreenx} onHide={() => setShowx(false)}>
     <Modal.Header closeButton>
       <Modal.Title>4</Modal.Title>
     </Modal.Header>
     <Modal.Body>4</Modal.Body>
   </Modal>
   {/*preview part ends ================================== */}
   </Col>
  </Row>

  <Row className="pop-row">
   <Col lg={3} md={3}>
   <div className="preone">
   <img src="../images/pre4.png" alt="Logo"/>
   </div>
   </Col>
   <Col lg={6} md={6} className="lorem-all">
   <div className="lorem-headingone">
   <h5>Lorem Ipsum Dolor</h5>
   </div>
   <div className="lorem-paraone">
   <p>Lorem Ipsum</p>
   </div>
    </Col>
   <Col lg={3} md={3}>
    {/* preview part pop up start===============================*/}
  <div className="useit">
  {values.map((v, idx) => (
   <a key={idx} className="usethisone" onClick={() => handleShowy(v)}>
     Preview
      {typeof v === 'string' && `below ${v.split('-')[0]}`}
    </a>
    ))}
    </div>

    <div className="usethis">
    <a className="usethistwo">Use This Template</a>
    </div>
 
  <Modal show={showy} fullscreen={fullscreeny} onHide={() => setShowy(false)}>
    <Modal.Header closeButton>
      <Modal.Title>5</Modal.Title>
    </Modal.Header>
    <Modal.Body>5</Modal.Body>
  </Modal>
  {/*preview part ends ================================== */}
   </Col>
  </Row>
   </Container>

     {/*  internal design  ends===========================> */}
     </Modal.Body>
   </Modal>
     {/*  template pop up start==============> */}
      </div>
      </Col>
    {/* select template ends====================================== */}
      </Row>
      </Container>
    
      {/* side navbar part start ==========================*/}
      <Container fluid>
       <Row>
        <div className="all-in">
          <div className="side-circle ">
            <div className="best-flexs">
              <NavLink
                className="nav-link active"
                aria-current="page"
                to="/FullPageView"
              >
              <div className="bscircle" />
              </NavLink>
              <NavLink
                className="nav-link active"
                aria-current="page"
                to="/PageTwo"
              >
              <div className="bscircle"/>
              </NavLink>
              <NavLink
                className="nav-link active"
                aria-current="page"
                to="/PageThree"
              >
                <div className="bscircle"/>
              </NavLink>
            </div>
           
            {/*  pagination starts ==========================*/}
          {/*  <div className="pagtwo">
              <Col lg={2} md={2} className="react-pag">
                <ReactPaginate
                  // previousLabel={"<"}
                  // nextLabel={">"}
                  pageCount={pageCount}
                  onPageChange={handlePageClick}
                  containerClassName={"paginations"}
                  previousLinkClassName={"pagination_links"}
                  nextLinkClassName={"pagination_links"}
                  disabledClassName={"pagination_link--disabled"}
                  activeClassName={"pagination_link--actives"}
                />
              </Col>
          </div> */}
          {/*  pagination ends ===========================================*/}
          </div>
         {/* side navbar part ends========================================*/}

         {/* question drag and drop part start ==============================>*/}
           <Dragdrop
             questions={current}
             onDragEnd={onDragEnd}
             components={components}
             setComponents={setComponents}
             addComponent={addComponent}
           />
          {/* question drag and drop part ends ==============================>*/}


          
        {/*off canvas part start ================================================*/}

          <div className="canvas">
            <div className=" pls-ques">
              <a className="side-plus" onClick={handleShow}>
                <AiOutlinePlusCircle/>
              </a>
            </div>

            <Offcanvas show={show} onHide={handleClose}>
              <Offcanvas.Header closeButton>
                <Offcanvas.Title>Recommended Questions</Offcanvas.Title>
              </Offcanvas.Header>
              <Offcanvas.Body>
                {/*  question part start========================================*/}

                <div className="input">
                  <form onSubmit={handleData}>
                    <Row>
                      <div className="q-para">
                        <p>Questions Category</p>
                      </div>
                      {/* Bolean questions start ================================*/}
                      <div className="bool">
                        <Col md={12} lg={12}>
                        <div className="boolean-heading">
                        <h4>Boolean Questions</h4>
                        </div>
                       

                          {postsData.map((postItem) => (
                            <div className="flexo">
                              <input
                                className="unique-first"
                                type="checkbox"
                                value={postItem.question.title}
                                onChange={(e) =>
                                  handleSelect(
                                    e,
                                    postItem.id,
                                    postItem.question
                                  )
                                }
                                checked={
                                  selectedPosts.findIndex(
                                    (item) => item.id === postItem.id
                                  ) !== -1
                                }
                              />
                              <label
                                class="form-check-label"
                                for="flexCheckDefault"
                              >
                                {postItem.question.title}
                              </label>
                            </div>
                          ))}
                        </Col>
                      </div>
                      {/* Boolean questions ends ================================*/}
                    </Row>

                    <Row>
                      <div className="special-button">
                        <button type="Submit" className="next" onClick={handleClose}>
                          Add +
                        </button>
                      </div>
                    </Row>
                  </form>
                </div>
              </Offcanvas.Body>
            </Offcanvas>
          </div>

          {/* off canvas part ends================================================= */}
          </div>
        </Row>
      </Container>
    </>
  );
}

export default App;











<div className="useit">
  {values.map((v, idx) => (
   <a key={idx} className="usethisone" onClick={() => handleShowu(v)}>
     Preview
      {typeof v === 'string' && `below ${v.split('-')[0]}`}
    </a>
    ))}
    </div>

    <div className="usethis">
    <a className="usethistwo" type="submit">Use This Template</a>
    </div>
   
  <Modal show={showu} fullscreen={fullscreenu} onHide={() => setShowu(false)}>
  <Modal.Header closeButton>
  </Modal.Header>
  <Modal.Body>
  {/*  page design start =============================>*/}
   {preview}
  {/*  page design ends =============================>*/}
  </Modal.Body>
  </Modal>







  {/* preview part pop up start===============================*/}
     
  <Button variant="primary" onClick={handleShowr}>
  Preview
  </Button>

  <Modal show={showr} onHide={handleCloser}>
  <Modal.Header closeButton>
    <Modal.Title>Modal heading</Modal.Title>
  </Modal.Header>
  <Modal.Body>
   <p>{preview}</p>
  </Modal.Body>
  <Modal.Footer>
    <Button variant="secondary" onClick={handleCloser}>
      Close
    </Button>
    <Button variant="primary" onClick={handleCloser}>
      Save Changes
    </Button>
   </Modal.Footer>
   </Modal>

  {/*preview part ends ================================== */}